<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Equipment & Deck Building - Penance</title>
    <link rel="stylesheet" href="manuscript-style.css">
    <style>
        .equipment-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .equipment-card {
            background: linear-gradient(135deg, #1a1410 0%, #2b1f17 100%);
            border: 2px solid #4a0e0e;
            border-radius: 8px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .equipment-card:hover {
            border-color: #6b1a1a;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 14, 14, 0.4);
        }

        .equipment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid #4a0e0e;
        }

        .equipment-name {
            font-family: 'Cinzel Decorative', serif;
            font-size: 1.3rem;
            color: #b8956a;
            font-weight: 700;
        }

        .equipment-count {
            background: #4a0e0e;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-size: 0.85rem;
            color: #d4c5b0;
        }

        .equipment-meta {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .equipment-meta-item {
            display: flex;
            justify-content: space-between;
            padding: 0.4rem;
            background: rgba(42, 31, 23, 0.5);
            border-radius: 4px;
        }

        .meta-label {
            color: #b8956a;
            font-weight: 600;
        }

        .meta-value {
            color: #d4c5b0;
        }

        .equipment-cards-list {
            margin-top: 1rem;
        }

        .card-item {
            background: rgba(26, 20, 16, 0.6);
            border-left: 3px solid #6b1a1a;
            padding: 0.75rem;
            margin-bottom: 0.75rem;
            border-radius: 4px;
        }

        .card-name {
            font-weight: 700;
            color: #b8956a;
            margin-bottom: 0.25rem;
            font-size: 1rem;
        }

        .card-cost {
            display: inline-block;
            background: #2d0a0a;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            font-size: 0.8rem;
            color: #d4c5b0;
            margin-right: 0.5rem;
        }

        .card-type {
            display: inline-block;
            background: #4a0e0e;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            font-size: 0.8rem;
            color: #b8956a;
            margin-right: 0.5rem;
        }

        .card-effect {
            color: #d4c5b0;
            font-size: 0.9rem;
            margin-top: 0.5rem;
            line-height: 1.4;
        }

        .filter-section {
            background: linear-gradient(135deg, #2b1f17 0%, #1a1410 100%);
            border: 2px solid #4a0e0e;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .filter-title {
            font-family: 'Cinzel Decorative', serif;
            font-size: 1.2rem;
            color: #b8956a;
            margin-bottom: 1rem;
        }

        .filter-options {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .filter-btn {
            background: #4a0e0e;
            border: 2px solid #6b1a1a;
            color: #d4c5b0;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }

        .filter-btn:hover {
            background: #6b1a1a;
            border-color: #b8956a;
        }

        .filter-btn.active {
            background: #6b1a1a;
            border-color: #b8956a;
            color: #b8956a;
            font-weight: 600;
        }

        .loading-message {
            text-align: center;
            padding: 3rem;
            font-size: 1.2rem;
            color: #b8956a;
        }

        .section-header {
            font-family: 'Cinzel Decorative', serif;
            font-size: 1.8rem;
            color: #b8956a;
            margin: 2rem 0 1rem 0;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid #4a0e0e;
        }
    </style>
</head>
<body>
    <div class="content">
        <div class="breadcrumb">
            <a href="content-home.html" target="_parent">CODEX</a> /
            <a href="#equipment">EQUIPMENT</a> /
            Equipment Decks
        </div>
<h1>Equipment & Deck Building</h1>
        <p class="subtitle">The Arsenal of the Bound</p>

        <div class="section-break"></div>

        <h2>Equipment System Overview</h2>

        <h3>Deck Composition Formula</h3>
        <p><strong>Total Deck Size = 6 Faction Cards + 10 Universal Cards + Equipment Cards</strong></p>
        <p>Where Equipment Cards = 2 equipment items chosen (typically 13-19 cards total)</p>
        <p><strong>Total Deck Size:</strong> ~29-35 cards</p>

        <div class="callout-box">
            <h4>Card-as-HP System</h4>
            <p>Your deck size = your health. When you take damage, cards are permanently removed to the <strong>damage pile</strong> and cannot be recovered (except through specific faction abilities).</p>
        </div>

        <h3>Equipment Slots by Casket Class</h3>
        <table>
            <thead>
                <tr>
                    <th>Casket Class</th>
                    <th>Equipment Slots</th>
                    <th>Typical Deck Size</th>
                    <th>Notes</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Scout</strong> (Light)</td>
                    <td>2 items</td>
                    <td>~29-32 cards</td>
                    <td>Fast, mobile</td>
                </tr>
                <tr>
                    <td><strong>Warden</strong> (Medium)</td>
                    <td>2 items</td>
                    <td>~30-33 cards</td>
                    <td>Balanced loadout</td>
                </tr>
                <tr>
                    <td><strong>Vanguard</strong> (Heavy)</td>
                    <td>2 items</td>
                    <td>~31-34 cards</td>
                    <td>Durable, slower</td>
                </tr>
                <tr>
                    <td><strong>Colossus</strong> (Fortress)</td>
                    <td>2 items</td>
                    <td>~32-35 cards</td>
                    <td>Maximum durability</td>
                </tr>
            </tbody>
        </table>

        <p class="manuscript-text"><em>Note: Equipment cards use Heat costs (0-2 Heat per card) or faction-specific resource economies. All equipment data loaded from the official card database.</em></p>

        <div class="section-break"></div>

        <!-- Filter Section -->
        <div class="filter-section">
            <div class="filter-title">Filter Equipment</div>
            <div class="filter-options">
                <button class="filter-btn active" data-category="all">All</button>
                <button class="filter-btn" data-category="Weapon">Weapons & Shields</button>
                <button class="filter-btn" data-category="Spell Equipment">Spell Equipment</button>
                <button class="filter-btn" data-category="other">Accessories & Sigils</button>
            </div>
            <div class="filter-options" style="margin-top: 1rem;">
                <button class="filter-btn active" data-faction="all">All Factions</button>
                <button class="filter-btn" data-faction="universal">Universal</button>
                <button class="filter-btn" data-faction="church">Church</button>
                <button class="filter-btn" data-faction="dwarves">Dwarves</button>
                <button class="filter-btn" data-faction="elves">Elves</button>
                <button class="filter-btn" data-faction="undead">Ossuarium</button>
                <button class="filter-btn" data-faction="fae">Wyrd Conclave</button>
                <button class="filter-btn" data-faction="nomads">Nomads</button>
            </div>
        </div>

        <!-- Equipment Grid (Dynamically Loaded) -->
        <div class="section-header">Equipment Database</div>
        <div id="equipment-container" class="loading-message">
            Loading equipment from card database...
        </div>

        <div class="section-break"></div>

        <h2>Smelting & Salvage</h2>

        <h3>Smelting Equipment</h3>
        <p>When you no longer need equipment:</p>
        <ul>
            <li><strong>Smelt</strong> equipment → Remove all cards from deck</li>
            <li>Gain <strong>Scrap Tokens</strong>: 1 Scrap per 2 cards smelted (round down)</li>
            <li>Minimum 1 Scrap (even if only 2-card equipment)</li>
        </ul>

        <p><strong>Examples</strong>:</p>
        <ul>
            <li>Greatsword (8 cards) → Smelt → Gain 4 Scrap</li>
            <li>Dagger (3 cards) → Smelt → Gain 1 Scrap</li>
        </ul>

        <h3>Salvaging Enemy Equipment</h3>
        <p>When you destroy an enemy Casket:</p>
        <ul>
            <li>Roll 1d20 on <strong>Salvage Table</strong></li>
            <li>On 15+, recover 1 random equipment card from their deck</li>
            <li>That equipment can be used even if your faction cannot craft it</li>
        </ul>

        <p><strong>Looted Gear Rules</strong>:</p>
        <ul>
            <li>Cannot be repaired/upgraded (no Research)</li>
            <li>If destroyed, gone forever (cannot re-craft)</li>
            <li>Can be smelted for Scrap normally</li>
        </ul>

        <div class="section-break"></div>

        <h2>Crafting Tiers</h2>

        <table>
            <thead>
                <tr>
                    <th>Tier</th>
                    <th>Equipment Type</th>
                    <th>Card Count</th>
                    <th>Crafting Cost</th>
                    <th>Examples</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Basic</strong></td>
                    <td>Light weapons, shields, light spell foci</td>
                    <td>2-3 cards</td>
                    <td>2 Scrap</td>
                    <td>Dagger, Buckler, Flame Wand, Frost Focus</td>
                </tr>
                <tr>
                    <td><strong>Standard</strong></td>
                    <td>Medium weapons, plating, grimoires</td>
                    <td>4-6 cards</td>
                    <td>3-4 Scrap</td>
                    <td>Longsword, Crossbow, Pyromancer's Grimoire</td>
                </tr>
                <tr>
                    <td><strong>Advanced</strong></td>
                    <td>Heavy weapons, sigils, artifact staves</td>
                    <td>6-8 cards</td>
                    <td>5-6 Scrap</td>
                    <td>Greatsword, Warhammer, Inferno Staff</td>
                </tr>
                <tr>
                    <td><strong>Faction</strong></td>
                    <td>Exclusive sigils/weapons/spells</td>
                    <td>3-7 cards</td>
                    <td>5-6 Scrap</td>
                    <td>Forge-Rune, Divine Scepter, Staff of the Grave</td>
                </tr>
            </tbody>
        </table>

        <div class="section-break"></div>

        <h2>Equipment Restrictions by Faction</h2>

        <table>
            <thead>
                <tr>
                    <th>Faction</th>
                    <th>Allowed Weapons</th>
                    <th>Forbidden Weapons</th>
                    <th>Special Access</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Church</strong></td>
                    <td>All weapons</td>
                    <td>None</td>
                    <td>Can dual-wield</td>
                </tr>
                <tr>
                    <td><strong>Dwarves</strong></td>
                    <td>Axes, Hammers, Picks, Cannons</td>
                    <td>Swords, Bows, Whips</td>
                    <td>All gain Armor-Piercing</td>
                </tr>
                <tr>
                    <td><strong>Elves</strong></td>
                    <td>Swords, Bows, Daggers, Spears, Whips</td>
                    <td>Hammers, Axes, Firearms</td>
                    <td>All gain Bleed</td>
                </tr>
                <tr>
                    <td><strong>Ossuarium</strong></td>
                    <td>Bone weapons, Scavenged, Necrotic Relics</td>
                    <td>Holy Relics, Living Wood</td>
                    <td>Can Reanimate destroyed gear</td>
                </tr>
                <tr>
                    <td><strong>Wyrd Conclave</strong></td>
                    <td>Fae Artifacts, Stolen weapons, Illusions</td>
                    <td>Iron/Steel, Dwarven Runes</td>
                    <td>Transmute weapon once/mission</td>
                </tr>
                <tr>
                    <td><strong>Vestige Bloodlines</strong></td>
                    <td>Grafted Claws, Bio-Cannons, Carapace</td>
                    <td>Manufactured, Holy, Elven</td>
                    <td>Equipment Evolves (+1 card after 3 missions)</td>
                </tr>
                <tr>
                    <td><strong>Nomad Collective</strong></td>
                    <td>All improvised, salvaged weapons</td>
                    <td>None</td>
                    <td>Field Modification (combine 2 weapons)</td>
                </tr>
                <tr>
                    <td><strong>The Exchange</strong></td>
                    <td>Standardized arsenal, Imports</td>
                    <td>Fae Artifacts, Bio-Weapons</td>
                    <td>Can Rent equipment</td>
                </tr>
            </tbody>
        </table>

        <div class="section-break"></div>

        <!-- Navigation breadcrumbs -->
        <p style="margin-top: 3rem; font-size: 0.9rem; opacity: 0.7; text-align: center;">
            <a href="#" onclick="parent.loadContent('content-home.html'); return false;" style="color: var(--dark-red);">← Return to Codex Home</a>
        </p>

        <p style="font-style: italic; text-align: center; margin-top: 2rem; opacity: 0.8; font-size: 0.95rem;">
            "Your deck is your arsenal. Craft wisely. Fight brutally. Smelt the obsolete. Forge your legend in iron and blood."
        </p>
    </div>

    <script>
        let allEquipment = [];
        let currentCategoryFilter = 'all';
        let currentFactionFilter = 'all';

        async function loadEquipment() {
            try {
                let response;
                try {
                    response = await fetch('../cards/complete-card-data.json');
                } catch {
                    response = await fetch('../../docs/cards/complete-card-data.json');
                }
                const data = await response.json();
                allEquipment = data.equipment_items || [];

                renderEquipment();
                setupFilters();
            } catch (error) {
                console.error('Error loading equipment:', error);
                document.getElementById('equipment-container').innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #6b1a1a;">
                        <p>Error loading equipment data: ${error.message}</p>
                        <p style="font-size: 0.9rem; opacity: 0.7;">Please ensure complete-card-data.json is accessible.</p>
                    </div>
                `;
            }
        }

        function renderEquipment() {
            const container = document.getElementById('equipment-container');
            const filteredEquipment = allEquipment.filter(item => {
                let categoryMatch = false;
                if (currentCategoryFilter === 'all') {
                    categoryMatch = true;
                } else if (currentCategoryFilter === 'other') {
                    // "other" includes items with null category or "Equipment" category
                    categoryMatch = !item.category || (item.category !== 'Weapon' && item.category !== 'Spell Equipment');
                } else {
                    categoryMatch = item.category === currentCategoryFilter;
                }

                const factionMatch = currentFactionFilter === 'all' ||
                                    (item.faction && item.faction.toLowerCase().includes(currentFactionFilter));
                return categoryMatch && factionMatch;
            });

            if (filteredEquipment.length === 0) {
                container.innerHTML = '<div class="loading-message">No equipment matches the selected filters.</div>';
                return;
            }

            container.innerHTML = '';
            const grid = document.createElement('div');
            grid.className = 'equipment-grid';

            filteredEquipment.forEach(item => {
                const card = document.createElement('div');
                card.className = 'equipment-card';

                const header = document.createElement('div');
                header.className = 'equipment-header';
                header.innerHTML = `
                    <div class="equipment-name">${item.name}</div>
                    <div class="equipment-count">${item.totalCards} cards</div>
                `;
                card.appendChild(header);

                const meta = document.createElement('div');
                meta.className = 'equipment-meta';
                meta.innerHTML = `
                    ${item.category ? `<div class="equipment-meta-item">
                        <span class="meta-label">Type:</span>
                        <span class="meta-value">${item.category}</span>
                    </div>` : ''}
                    ${item.weight ? `<div class="equipment-meta-item">
                        <span class="meta-label">Weight:</span>
                        <span class="meta-value">${item.weight}</span>
                    </div>` : ''}
                    ${item.craftingCost ? `<div class="equipment-meta-item">
                        <span class="meta-label">Crafting:</span>
                        <span class="meta-value">${item.craftingCost}</span>
                    </div>` : ''}
                    <div class="equipment-meta-item">
                        <span class="meta-label">Faction:</span>
                        <span class="meta-value">${capitalize(item.faction || 'universal')}</span>
                    </div>
                `;
                card.appendChild(meta);

                if (item.cards && item.cards.length > 0) {
                    const cardsList = document.createElement('div');
                    cardsList.className = 'equipment-cards-list';

                    item.cards.forEach(cardData => {
                        const cardItem = document.createElement('div');
                        cardItem.className = 'card-item';

                        const cardHeader = document.createElement('div');
                        cardHeader.className = 'card-name';
                        cardHeader.textContent = cardData.name;
                        cardItem.appendChild(cardHeader);

                        const cardMeta = document.createElement('div');
                        cardMeta.innerHTML = `
                            ${cardData.cost !== undefined ? `<span class="card-cost">Cost: ${cardData.cost}</span>` : ''}
                            ${cardData.type ? `<span class="card-type">${cardData.type}</span>` : ''}
                            ${cardData.range ? `<span class="card-type">${cardData.range}</span>` : ''}
                        `;
                        cardItem.appendChild(cardMeta);

                        if (cardData.effect) {
                            const cardEffect = document.createElement('div');
                            cardEffect.className = 'card-effect';
                            cardEffect.textContent = cardData.effect;
                            cardItem.appendChild(cardEffect);
                        }

                        cardsList.appendChild(cardItem);
                    });

                    card.appendChild(cardsList);
                }

                grid.appendChild(card);
            });

            container.appendChild(grid);
        }

        function setupFilters() {
            const categoryButtons = document.querySelectorAll('[data-category]');
            const factionButtons = document.querySelectorAll('[data-faction]');

            categoryButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    categoryButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentCategoryFilter = btn.dataset.category;
                    renderEquipment();
                });
            });

            factionButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    factionButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentFactionFilter = btn.dataset.faction;
                    renderEquipment();
                });
            });
        }

        function capitalize(str) {
            return str.split(' ').map(word =>
                word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()
            ).join(' ');
        }

        // Load equipment on page load
        loadEquipment();
    </script>
</body>
</html>
